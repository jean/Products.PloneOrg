OVERVIEW
========

Steps performed to migrate plone.org from 2.5.4-devel (svn/unreleased) to 3.1-beta1
--------------------------------------------------------------------------------

o Make sure the site runs in production mode, not debug mode (ie. no zopectl
  fg) XXX: Why? I'm running it in the fg...

o Log in as the "admin" user (for some reason, there are failures if you do it as 
    other admin users like "rootlimi" - could it be because there is an admin user both outside and inside the site?)
    XXX: Not sure... but I think I had the same problem.

o Go to ZMI -> portal_migration

    - Force upgrade from Plone 2.5.4-devel (since plone.org is running an SVN version of the 2.5 branch)
        XXX: I used an earlier version to make sure I didn't miss any migration
        steps. i.e. you could also run it from version 1, right?

    - Watch the uncannily quick migration ;)

o Go to ZMI -> archetype_tool -> Update Schema

    - Select all the classes and the checkbox at the bottom to Remove schema
      attributes.

    - Watch the uncannily long schema update ;)

o Test that you can load the front page (it will be slow for now)

o Go to portal_skins in the ZMI and rename 'custom' to 'custom_old', and create a new, 
    blank custom folder. The site will now be a bit faster.

o Go to /Control_Panel/Products/manage_main and delete all the product entries, so they update 
    when you restart (reinstalling will result in the blank version bug if you don't do this and 
    the products have different paths. Why these are persistent is anybody's guess, probably 
    because Zope needs to support ZClasses)
    XXX: This is not strictly necessary, but is "nice to have" :-)

o Go to Site Setup and reinstall all the add-on products that need it.
    - PloneSoftwareCenter takes forever to reinstall. 
        Examine whether it's doing a total reindex, and whether this is actually necessary.
        XXX: Still not sure about why PSC is doing this.

    - PloneSoftwareCenter is blank after upgrading (it doesn't list any
        releases, but they are still there, of course, run).  
        XXX: Run a catalog update to fix this.

o Go to /products and select the plonesoftwarecenter_ploneorg template from the 'Display' menu.

o Make sure the JS and CSS registries emit as few units as possible (ideally just one each, 
    the front page will probably have two with the current setup). The tabber JS is included in 
    Plone, so can be removed from the page, I assume.
    XXX: Hmmm, I don't understand this one.

o Go to portal_skins and make sure there are no bogus entries. When starting up locally, 
    I get references to at least the following non-existant entries:
     irclogs refers to a non-existing path 
     keyword_manager refers to a non-existing path
     cache_prefs_plone20 refers to a non-existing path 
     plone_tableless refers to a non-existing path
     cache_setup_globals refers to a non-existing path
    XXX: Does that mean delete them from portal_skins ? 

o Make the front page 4x faster by removing the legacy portlets (really!):
  Go to /@@manage-portlets in the site root, convert legacy portlets if it 
  asks, then remove them from the listings. This reduces the front page 
  rendering time from 24s to 6s on my laptop.
  Additionally, if you remove everything but the navigation portlet (which is
  really the only thing we use on plone.org on all levels), it goes down to
  5s. For extra brownie points, remove the navigation portlet from the root,
  and only add it to the subfolders. This further reduces the page load time
  to 4.5s.

    XXX: I think the newer Plone 3 migrations must do this for you.


KNOWN ISSUES:
============

o TypesTool throws an AttributeError: IRCLogs, I assume we need to just delete the IRCLogs entry from portal_types

o CacheSetup adds a Cache Configuration Tool tab to the portal, WTF? :)

    XXX: Has this been fixed with the newest CacheFu release, perhaps?
        </wishful_thinking>

o Fix INFO/WARNINGS
    - These occur during normal operation of the site, but we should look into
      fixing them.

    2007-11-24 18:06:56 INFO Archetypes ArchetypesTool: Trying to register "PloneHelpCenter.HelpCenterTutorial" which has already been registered.  The new type Products.PloneHelpCenter.types.Tutorial.HelpCenterTutorial is going to override Products.PloneHelpCenter.content.Tutorial.HelpCenterTutorial

    2007-11-24 18:06:58 INFO Archetypes ArchetypesTool: Trying to register "PloneHelpCenter.HelpCenterTutorialPage" which has already been registered.  The new type Products.PloneHelpCenter.types.TutorialPage.HelpCenterTutorialPage is going to override Products.PloneHelpCenter.content.TutorialPage.HelpCenterTutorialPage

    2007-11-24 18:07:31 INFO Archetypes ArchetypesTool: Trying to register "PloneHelpCenter.HelpCenterReferenceManual" which has already been registered.  The new type Products.PloneHelpCenter.types.ReferenceManual.HelpCenterReferenceManual is going to override Products.PloneHelpCenter.content.ReferenceManual.HelpCenterReferenceManual

    2007-11-24 18:07:31 INFO Archetypes ArchetypesTool: Trying to register "PloneHelpCenter.HelpCenterReferenceManualSection" which has already been registered.  The new type Products.PloneHelpCenter.types.ReferenceManualSection.HelpCenterReferenceManualSection is going to override Products.PloneHelpCenter.content.ReferenceManualSection.HelpCenterReferenceManualSection

    2007-11-24 18:07:32 INFO Archetypes ArchetypesTool: Trying to register "PloneHelpCenter.HelpCenterReferenceManualPage" which has already been registered.  The new type Products.PloneHelpCenter.types.ReferenceManualPage.HelpCenterReferenceManualPage is going to override Products.PloneHelpCenter.content.ReferenceManualPage.HelpCenterReferenceManualPage

    2007-11-24 18:07:57 INFO Archetypes ArchetypesTool: Trying to register "PloneHelpCenter.HelpCenterErrorReference" which has already been registered.  The new type Products.PloneHelpCenter.types.ErrorReference.HelpCenterErrorReference is going to override Products.PloneHelpCenter.content.ErrorReference.HelpCenterErrorReference

    2007-11-24 18:08:00 INFO Archetypes ArchetypesTool: Trying to register "PloneHelpCenter.HelpCenterLink" which has already been registered.  The new type Products.PloneHelpCenter.types.Link.HelpCenterLink is going to override Products.PloneHelpCenter.content.Link.HelpCenterLink

    2007-11-24 18:08:03 INFO Archetypes ArchetypesTool: Trying to register "PloneHelpCenter.HelpCenterDefinition" which has already been registered.  The new type Products.PloneHelpCenter.types.Definition.HelpCenterDefinition is going to override Products.PloneHelpCenter.content.Definition.HelpCenterDefinition

    2007-11-24 18:08:11 WARNING OFS.Uninstalled Could not import class 'PersistentOutline' from module 'Products.ZWiki.OutlineSupport'

    WARNING ZODB Could not import class 'CMFWikiPage' from module 'Products.CMFWiki.CMFWikiPage'

    WARNING ZODB Could not import class 'CMFWikiFolder' from module 'Products.CMFWiki.CMFWikiPage'

    WARNING ZODB Could not import class 'CMFPhotoAlbum' from module 'Products.CMFPhotoAlbum'

    WARNING ZODB Could not import class 'PersistentOutline' from module 'Products.ZWiki.OutlineSupport'

    WARNING ZODB Could not import class 'AmazonItem' from module 'Products.ATAmazon.AmazonItem'

